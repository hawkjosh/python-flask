{% extends "base.html" %} {% block nav %} {% include 'partials/nav_auth_no_post.html' %}
{% endblock nav %} {% block content %}
<div class="comments-list-container">
	{% if grouped_replies|length == 0 %}
	<div class="no-comments-msg-wrapper">
    <div class="no-comments-msg">
      You have not replied to any comments yet...what are you waiting for?!?
    </div>
  </div>
	{% elif replies|length == 1 and grouped_replies|length == 1 %}
	<div class="current-user-page-header">
		You have {{ replies|length }} reply to a comment
	</div>
	{% elif replies|length > 1 and grouped_replies|length == 1 %}
	<div class="current-user-page-header">
		You have {{ replies|length }} total replies to {{ grouped_replies|length }} comment
	</div>
	{% else %}
	<div class="current-user-page-header">
		You have {{ replies|length }} total replies to {{ grouped_replies|length }} different comments
	</div>
	{% endif %}
	{% for comment_id, replies in grouped_replies.items() %} {% set comment =
	replies[0].comment %}
	<div class="{% if comment.user_id == current_user.id %}comment-card curr-user{% else %}comment-card{% endif %}">
		<div class="comment-content">{{ comment.content }}</div>
		<div class="comment-info-container">
			<div class="comment-info">
				<div class="comment-subtext">
					Posted by
					<span class="{% if comment.user_id == current_user.id %}strong curr-user{% else %}strong user{% endif %}">{{
						comment.id|comment_username }}</span>
					on
					<span class="strong">{{ comment.created_at|clean_date }}</span>
				</div>
				<div class="comment-counts">
					<div class="replies-count-wrapper">
						<a class="{% if comment.replies|length == 0 %}replies-count{% elif comment.user_id == current_user.id %}replies-count curr-user{% else %}replies-count user{% endif %}"
							href="{{ url_for('replies', comment_id=comment.id) }}" role="button">
							{{ comment.replies|length|pluralize_reply }}
						</a>
						{% if comment.replies %}
						<div
							class="{% if comment.user_id == current_user.id %}replies-tooltip curr-user{% else %}replies-tooltip{% endif %}">
							{% for reply in comment.replies %}
							<span class="reply-username">{{ reply.id|reply_username }}</span>
							{% endfor %}
						</div>
						{% endif %}
					</div>
					<span class="count-divider">|</span>
					<div class="likes-count-wrapper">
						<span
							class="{% if comment.likes|length == 0 %}likes-count{% elif comment.user_id == current_user.id %}likes-count curr-user{% else %}likes-count user{% endif %}">{{
							comment.likes|length|pluralize_like }}</span>
						{% if comment.likes %}
						<div
							class="{% if comment.user_id == current_user.id %}likes-tooltip curr-user{% else %}likes-tooltip{% endif %}">
							{% for like in comment.likes %}
							<span class="likes-username">{{ like.id|like_username }}</span>
							{% endfor %}
						</div>
						{% endif %}
					</div>
				</div>
			</div>
		</div>

		<div class="comment-replies-divider">
			<hr
				class="{% if comment.user_id == current_user.id %}comment-replies-divider-line curr-user{% else %}comment-replies-divider-line{% endif %}" />
		</div>

		<div class="comment-replies-label">Your replies...</div>
		{% for reply in replies|sort(attribute="created_at") %}
		<div class="comment-reply-content">
			{{ reply.content }}<span class="user-replies-subtext"> ({{ reply.created_at|clean_date }})</span>
		</div>
		{% endfor %}
	</div>
	{% endfor %}
</div>
{% endblock content %}